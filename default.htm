<html>
  <header>
    <!--<tit>test webSocket</tit>-->
    <script src="./x/xterm.js" type="module"></script>
    <script src="./x/a-attach-x.js" type="module"></script>
    <script src="./x/a-fit-x.js" type="module"></script>
    <link href="./x/xterm.css" rel="stylesheet" />
  </header>
  <body>
    <div
      class="c-header"
      style="">
      </div>
    <div
      class="c-nav"
      style="">
      </div>
    <div
      class="c-main"
      style="">
      <!--<div class="pre" id="t1"></div>-->
      <div id="consoleShow" class="pre"></div>
      <!--<div class="pre" id="t2"></div>-->
      <style><!--
      body {
        margin: 0 auto;
        min-width: 1002px;
        background-color: #ffffff;
        min-height: 521px;
        padding: 0
      }
      /*scroll-custom-webkit {
        -webkit-scrollbar: ; -webkit-scrollbar-button: ; -webkit-scrollbar-thumb: ; -webkit-scrollbar-track: ; -webkit-scrollbar-track-piece: ; -webkit-scrollbar-corner: ; -webkit-resizer: ;
      }*/
      #consoleShow::-webkit-scrollbar-thumb {
        display: none
      }
      .c-header {
        height: calc(23% - 47px - 6px)
      }
      .c-nav {
        height: 47px;
        background-color: #cccccc;
        margin: 3px auto
      }
      .c-main {
        height: 60%
      }
      #consoleShow {
        width: 956px;
        font-size: 9px;
        height: calc(100% - 14px);
        line-height: 15px;
        background-color: #000000;
        padding: 7px 23px;
        margin: 0 auto;
        color: #ffffff;
        overflow-y: auto
      }
      .c-fgx {
        height: 7px;
        background-color: #ccc;
        margin: 3px auto
      }
      .c-footer {
        height: calc(17% - 7px - 6px)
      }
      div {
        width: 100%
      }
      --></style>
      <script type="module" _="">
        let mapObject = {}
        let pre = document.getElementsByClassName("pre") //
        // let ...
        for (let i=0;i < pre.length;i ++) {
          let xterm = new Terminal(), /*attachAddon = new AttachAddon.AttachAddon(wss),*/ fitAddon = new FitAddon.FitAddon()
              xterm.loadAddon(fitAddon); /*xterm.loadAddon(attachAddon);*/ xterm.open( pre[i] )
          /* ; */ mapObject[pre[i].id] = { x: xterm,f: fitAddon/*,a: attachAddon*/ }; fitAddon.fit()
        }
        /////

        ///
        let wss = new WebSocket("ws://"+self.location.host+"/?id={{.tstmp}}"); wss.onmessage = function(e) { let log = eval('('+e.data+')'); for (let key in mapObject) { if (log[key]==undefined) {continue};let textContent = log[key].match(/\n$/)!=null ? log[key] : log[key]+"\r\n";mapObject[key].x.write(textContent);/* ; */pre[key].scrollTop=pre[key].scrollHeight }; console.log(log) }; ///console.log(wss.readyState)
        ///

        let reSize = function(key) {
          mapObject[key].f.fit()
        }
        window.addEventListener('onresize', resize => {
          for (let key in mapObject) {
            mapObject[key].f.fit()
          }
        })
        ///
      </script>
    </div>
    <div
      class="c-fgx"
      style="">
      </div>
    <div
      class="c-footer"
      style="">
      </div>
  </body>
</html>