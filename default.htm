<!doctype html>
<html style="width:100%;height:100%;line-height:100%;margin:0 auto;padding:0" _="">
  <header>
    <title>test webSocket</title>
    <link rel="stylesheet" type="text/css" href="" />
    <script src="./x/xterm.js" type="module"></script>
    <script src="./x/a-attach-x.js" type="module"></script>
    <script src="./x/a-fit-x.js" type="module"></script>
    <link href="./x/xterm.css" rel="stylesheet" />
  </header>
    <script src="https://code.jquery.com/jquery.js" type=""></script>
  <body style="width:100%;line-height:100%;height:100%" _="">
    <div
      class="c-header"
      style="">
      </div>
    <div
      class="c-nav"
      style="">
      <div class="pre" style="" _="" id="ready"></div>
      </div>
    <div
      class="c-main"
      style="">
      <!---->
      <div class="pre" style="font-size:17px;line-height:132%;border-width:7px 21px;border-style:double solid;border-color:#ff0000 #0000ff;background-color:#000;color:#ffff;margin:0;width:calc(80% - 42px);height:calc(100% - 14px);left:0px;position:relative;top:calc(0px);display:flex;/*justify-content:center;*/align-items:center;z-index:+1" _="" id="t1"></div>
      <!---->
      <!---->
      <div class="pre" style="font-size:17px;line-height:132%;border-width:7px 21px 7px 21px;border-style:double solid double solid;border-color:#ff0000 #0000ff #ff0000 #0000ff;background-color:#000;color:#ffff;white-space:pre-wrap;word-wrap:break-word;margin:0;width:calc(80% - 42px);height:calc(100% - 14px);left:80%;position:relative;top:calc(-100%);display:flex;/*justify-content:center;*/align-items:center;z-index:+3" _="" id="consoleShow"></div>
      <!---->
      <!---->
      <div class="pre" style="font-size:17px;line-height:132%;border-width:7px 21px;border-style:double solid;border-color:#ff0000 #0000ff;background-color:#000;color:#ffff;margin:0;width:calc(80% - 42px);height:calc(100% - 14px);left:90%;position:relative;top:calc(-200%);display:flex;/*justify-content:center;*/align-items:center;z-index:+5" _="" id="t2"></div>
      <!---->
      <style><!--
      * {
        /*width: 100%;
        height: 100%;*/
        line-height: 100%;
        margin: 0 auto;
        padding: 0
      }
      body {
        /* min-width: 1002px;
        background-color: #ffffff;
        min-height: 521px; */
      }
      /*scroll-custom-webkit {
        -webkit-scrollbar: ; -webkit-scrollbar-button: ; -webkit-scrollbar-thumb: ; -webkit-scrollbar-track: ; -webkit-scrollbar-track-piece: ; -webkit-scrollbar-corner: ; -webkit-resizer: ;
      }*/
      .c-header {
        height: calc(23% - 47px - 6px)
      }
      .c-nav {
        margin: 3px auto;
        background-color: #cccccc;
        height: 47px
      }
      .c-nav .pre {
        height: 17px;
        position: relative;
        top: 15px
      }
      .c-main {
        overflow: hidden;
        width: calc(100% - 10%);
        height: 60%
      }
      .c-fgx {
        margin: 3px auto;
        background-color: #ccc;
        height: 19px
      }
      .c-fgx .pre {
        height: 17px;
        position: relative;
        top: 1px
      }
      .c-footer {
        height: calc(17% - 19px - 6px)
      }
      *::-webkit-scrollbar {
        width: 0px
      }
      div {
        /* display: flex;
        justify-content: center;
        align-items: center */
      }
      .pre {
        overflow-y: scroll;
        width: calc(100% - 42px);
        height: calc(100% - 14px);
        white-space: pre-wrap;
        word-wrap: break-word;
      }
      --></style>
      <script type="module" _="">$(document).ready(function(){
        let pre = document.getElementsByClassName("pre")
        var spaceWid = 0.2*$(".c-main").width()/(pre.length-2-1);$(".c-main .pre").each(function(i,o){ $(o).css("left",""+(i!=0?0.8*$(".c-main").width()+spaceWid*(i-1):0)+"px") });//console.log()
        let mapObject = {};for (let i=0;i < pre.length;i ++) {
          let xterm = new Terminal({disableStdin:true,convertEol:true,overviewRulerWidth:0,scrollback:999,tabStopWidth:2}), /*attachAddon = new AttachAddon.AttachAddon(wss),*/ fitAddon = new FitAddon.FitAddon();xterm.loadAddon(fitAddon); /*xterm.loadAddon(attachAddon);*/ xterm.open( pre[i] );/* ; */ mapObject[pre[i].id] = { x: xterm,f: fitAddon/*,a: attachAddon*/ }; mapObject[pre[i].id].f.fit()
        };window.mapObject = mapObject
        let wss = new WebSocket("ws://"+self.location.host+"/?id={{.tstmp}}")
        wss.onmessage = function(e) { let log = eval('('+e.data+')');for (let key in mapObject) { if (log[key]==undefined) {continue};let textContent = log[key].match(/\n$/)!=null ? log[key] : log[key] + (key==="ready"||key==="call" ? "" : "\n");mapObject[key].x.write(textContent);/* ; *//*pre[key].scrollTop=pre[key].scrollHeight*/ };/*console.log(log)*/ }
        ///obj.scrollTop = obj.scrollHeight
        var curShow = 0;$(".c-main .pre").each(function(i,o){
          $(o).bind("click", function(){ /**/;if (i>curShow){for (let c=curShow+1;c<=i;c= c+1){ $(".c-main .pre").eq(c).animate({"left":""+(c*spaceWid)+"px"}) }}else{for (let c=curShow;c>i;c= c-1){ $(".c-main .pre").eq(c).animate({"left":""+($(".c-main").width()-(pre.length-2-c)*spaceWid)+"px"}) }};curShow = i })
        });//console.log()
      })</script>
    </div>
    <div
      class="c-fgx"
      style="">
      <div class="pre" style="" _="" id="call"></div>
      </div>
    <div
      class="c-footer"
      style="">
      </div>
  </body>
</html>